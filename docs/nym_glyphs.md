# Nym Glyphs

Nym Glyphs provide anonymous, deterministic identities for each user within an instance. Every identity is derived from stable data and rendered client-side without persisting any extra database fields.

## Seed derivation

```
seed_input = "#{instance_id || 0}:#{user_id}:#{Rails.application.secret_key_base}"
seed = SHA256.hexdigest(seed_input)
```

* `instance_id` keeps glyphs unique per tenant. When absent, `0` is used.
* `user_id` ensures stability per account.
* `secret_key_base` means glyphs cannot be reversed to reveal the identifiers.

## Glyph rendering

* The hash bytes map to an 8Ã—8 grid of pixels rendered as inline SVG.
* Two colors are picked from a vaporwave palette based on the hash.
* SVG is generated by `nym_glyph_svg(user, instance:, size:, css_class:)` in `NymHelper`.

## Nym tags

* A human-readable pseudonym is created by `nym_tag(user, instance:)`.
* The tag combines an adjective, noun, and number (e.g., `nym:orchid-echo-12`).
* All components are chosen from in-memory word lists using the hash bytes.

## Privacy rationale

* No additional database tables or fields are required.
* Usernames/emails are not shown in the message feed when cloak mode is on; glyphs and nym tags are displayed instead.
* The secret salt keeps the mapping private even if glyphs/tags are observed externally.

## Customization

* Update the palettes or word lists in `app/helpers/nym_helper.rb` to change the visual output.
* CSS hooks: `.nym-glyph`, `.nym-glyph--small`, `.nym-glyph--message`, and `.nym-tag` can be themed in `app/assets/stylesheets/nymspace_vaporwave.scss`.
* The cloak chip in `app/views/rooms/show.html.erb` indicates anonymous mode and can be restyled alongside other room header elements.
